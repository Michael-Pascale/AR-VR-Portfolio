<!DOCTYPE html>
<html>
    <head>
        <link rel="icon" href="data:;base64,iVBORw0KGgo=">
        <title>AR DEMO</title>
        <script src="https://aframe.io/releases/1.0.2/aframe.min.js"></script>
        <script src="js/aframe-ar.js"></script>
        <script src="js/jquery.js"></script>
    </head>
    <body style="margin: 0px; overflow: hidden;">

    	<script>
    		AFRAME.registerComponent('startanimationonmarker', {
    			schema:{
    				event: {type: "string", default: 'start-anim'},
    				theanimation: {type: "string", default: '#marker-object-1'}
    			},
    			init: function(){
    				var marker = this.el;
    				let the_event = this.data.event
    				let the_object = this.data.theanimation

    				//This is how you add event listeners to the marker
					marker.addEventListener('markerFound', function() {
						var markerId = marker.id;
						console.log('markerFound', markerId);

						//This is how you can trigger startEvens
						document.querySelector(the_object).emit(the_event)
					});
    			}
    		});
    	</script>
        <a-scene embedded vr-mode-ui="enabled: false;" arjs="debugUIEnabled: false;">

            <a-assets>
                <img id="grid" src="images/border.png" />
                <img id="earth-flat" src="images/earth-flat.jpg" />
                <img id="earth-sphere" src="images/earth-sphere.jpg" />
                <img id="linkedin" src="images/linkedin.png">
            </a-assets>
            
            <a-marker type="pattern" url="data/kanji.patt">
                <a-box position="0 0.5 0" 
                       material="src:#grid; color: red; transparent: true; opacity: 0.50;">
                </a-box>
            </a-marker>
            <a-marker type="pattern" url="data/lambda.patt" emitevents="true" startanimationonmarker>
            	<a-plane position="0 0.5 0" id="marker-object-1" rotation = "-90 0 0"
                       material="src:#linkedin"
                       animation__comeout="property:position; from: 0 0.5 0; to: 2 0.5 0; dur: 1000; startEvents:start-anim;">
                </a-box>
            </a-marker>
            
            <a-entity camera></a-entity>
            
        </a-scene>
    </body>
<html>